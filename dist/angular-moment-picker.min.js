/*! Angular Moment Picker - v0.5.6 - https://github.com/indrimuska/angular-moment-picker - (c) 2015 Indri Muska - MIT */
!function(e){var t,n,i,a,o,r,s,l=function(){function t(){defaults={locale:"en",format:"L LT",minView:"decade",maxView:"day",datetimeDefault:!0,startView:"month",today:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",secondsFormat:"ss",minutesStep:5,secondsStep:1}}return t.prototype.options=function(t){return e.extend(defaults,t),e.copy(defaults)},t.prototype.$get=function(){return defaults},t}(),m=function(){function l(e,l,m,c,d,u,w){this.restrict="A",this.scope={model:"=momentPicker",locale:"@?",format:"@?",minView:"@?",maxView:"@?",datetimeDefault:"@?",startView:"@?",minDate:"=?",maxDate:"=?",today:"=?",disabled:"=?osDisabled",change:"&?",position:"@?"},t=e,n=l,i=m,r=u,a=c,o=d,s=w}return l.prototype.$inject=["$timeout","$sce","$compile","$document","$window","momentPicker"],l.prototype.require="?^form",l.prototype.link=function(l,m,c,d){l.template='<div class="moment-picker-container {{view.selected}}-view" ng-show="view.isOpen && !disabled" ng-class="{\'moment-picker-disabled\': disabled, \'open\': view.isOpen}"><table class="header-view"><thead><tr><th ng-class="{disabled: !view.previous.selectable}" ng-bind-html="view.previous.label" ng-click="view.previous.set()"></th><th ng-bind="view.title" ng-click="view.setParentView()"></th><th ng-class="{disabled: !view.next.selectable}" ng-bind-html="view.next.label" ng-click="view.next.set()"></th></tr></thead></table><div class="moment-picker-today-action" ng-click="setToday()"><span ng-bind="view.todayText"></span></div><div class="moment-picker-specific-views"><table ng-if="view.selected == \'decade\'"><tbody><tr ng-repeat="fourYear in decadeView.fourYears"><td ng-repeat="year in fourYear track by year.year" ng-class="year.class" ng-bind="year.label" ng-click="decadeView.setYear(year)"></td></tr></tbody></table><table ng-if="view.selected == \'year\'"><tbody><tr ng-repeat="fourMonth in yearView.fourMonths"><td ng-repeat="month in fourMonth track by month.month" ng-class="month.class" ng-bind="month.label" ng-click="yearView.setMonth(month)"></td></tr></tbody></table><table ng-if="view.selected == \'month\'"><thead><tr><th ng-repeat="day in monthView.days" ng-bind="day"></th></tr></thead><tbody><tr ng-repeat="days in monthView.weeks"><td ng-repeat="day in days track by day.date" ng-class="day.class" ng-bind="day.label" ng-click="monthView.setDate(day)"></td></tr></tbody></table><table ng-if="view.selected == \'day\'"><tbody><tr ng-repeat="threeHours in dayView.threeHours"><td ng-repeat="hour in threeHours track by hour.hour" ng-class="hour.class" ng-bind="hour.label" ng-click="dayView.setHour(hour)"></td></tr></tbody></table><table ng-if="view.selected == \'hour\'"><tbody><tr ng-repeat="minutes in hourView.minutes"><td ng-repeat="minute in minutes" ng-class="minute.class" ng-bind="minute.label" ng-click="hourView.setMinute(minute)"></td></tr></tbody></table><table ng-if="view.selected == \'minute\'"><tbody><tr ng-repeat="seconds in minuteView.seconds"><td ng-repeat="second in seconds" ng-class="second.class" ng-bind="second.label" ng-click="minuteView.setSecond(second)"></td></tr></tbody></table></div></div>',"false"===l.datetimeDefault&&(l.maxView="month"),e.forEach(["locale","format","minView","maxView","startView","today","leftArrow","rightArrow"],function(t){e.isDefined(l[t])||(l[t]=s[t]),e.isDefined(c[t])||(c[t]=l[t])}),l.momentToDate=function(t){return e.isDefined(t)&&t.isValid()?t.clone().toDate():void 0},l.valueUpdate=function(){l.value=l.momentToDate(l.valueMoment)},l.limits={isAfterOrEqualMin:function(t,n){return!e.isDefined(l.minDateMoment)||t.isAfter(l.minDateMoment,n)||t.isSame(l.minDateMoment,n)},isBeforeOrEqualMax:function(t,n){return!e.isDefined(l.maxDateMoment)||t.isBefore(l.maxDateMoment,n)||t.isSame(l.maxDateMoment,n)},isSelectable:function(e,t){return l.limits.isAfterOrEqualMin(e,t)&&l.limits.isBeforeOrEqualMax(e,t)},checkValue:function(){e.isDefined(l.valueMoment)&&(l.limits.isAfterOrEqualMin(l.valueMoment)||l.valueUpdate(l.valueMoment=l.minDateMoment.clone()),l.limits.isBeforeOrEqualMax(l.valueMoment)||l.valueUpdate(l.valueMoment=l.maxDateMoment.clone()))},checkView:function(){e.isDefined(l.view.moment)||(l.view.moment=moment().locale(l.locale)),l.limits.isAfterOrEqualMin(l.view.moment)||(l.view.moment=l.minDateMoment.clone()),l.limits.isBeforeOrEqualMax(l.view.moment)||(l.view.moment=l.maxDateMoment.clone()),l.view.update()}},l.views={all:["decade","year","month","day","hour","minute"],formats:{decade:"Y{1,2}(?!Y)|YYYY|[Ll]{1,4}(?!T)",year:"M{1,4}(?![Mo])|Mo|Q",month:"[Dd]{1,4}(?![Ddo])|DDDo|[Dd]o|[Ww]{1,2}(?![Wwo])|[Ww]o|[Ee]|L{1,2}(?!T)|l{1,2}",day:"[Hh]{1,2}|LTS?",hour:"m{1,2}|[Ll]{3,4}|LT(?!S)",minute:"s{1,2}|S{1,}|X|LTS"},detectMinMax:function(){var t,n;e.forEach(l.views.formats,function(i,a){var o=new RegExp("("+i+")(?![^[]*])","g");l.format.match(o)&&(e.isDefined(t)||(t=a),n=a)}),t=e.isDefined(t)?Math.max(0,l.views.all.indexOf(t)):0,n=e.isDefined(n)?Math.min(l.views.all.length-1,l.views.all.indexOf(n)):l.views.all.length-1,t>l.views.all.indexOf(l.minView)&&(l.minView=l.views.all[t]),n<l.views.all.indexOf(l.maxView)&&(l.maxView=l.views.all[n])}},l.view={isOpen:!1,selected:l.startView,update:function(){l.view.value=l.momentToDate(l.view.moment)},toggle:function(){l.view.isOpen?l.view.close():l.view.open()},open:function(){e.forEach(a[0].querySelectorAll(".moment-picker-container.open"),function(t){((e.element(t).scope().view||{}).close||e.noop)()}),l.disabled||(l.view.isOpen=!0),t(l.view.position,0,!1)},close:function(){l.view.isOpen=!1,l.view.selected=l.startView},position:function(){if(l.picker.removeClass("top").removeClass("left"),"top"===l.position)l.picker.addClass("top");else if("left"===l.position)l.picker.addClass("left");else if(!l.position){var e=l.container[0],t=function(e){var t,n,i,a;if(e)return e.getClientRects().length?(i=e.getBoundingClientRect()).width||i.height?(n=null!=(a=e.ownerDocument)&&a===a.window?e:9===a.nodeType&&a.defaultView,t=a.documentElement,{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i:{top:0,left:0}}(e),n=t.top-r.pageYOffset,i=t.left-r.pageXOffset,a=r.innerWidth,o=r.innerHeight;n+r.pageYOffset-e.offsetHeight>0&&n>o/2&&l.picker.addClass("top"),i+e.offsetWidth>a&&l.picker.addClass("left")}},unit:function(){return"decade"==l.view.selected?10:1},precision:function(){return l.view.selected.replace("decade","year")},title:"",previous:{selectable:!0,label:n.trustAsHtml(l.leftArrow),selectable:!0,set:function(){l.view.previous.selectable&&l.view.update(l.view.moment.subtract(l.view.unit(),l.view.precision()).toDate())}},next:{selectable:!0,label:n.trustAsHtml(l.rightArrow),set:function(){l.view.next.selectable&&l.view.update(l.view.moment.add(l.view.unit(),l.view.precision()).toDate())}},setParentView:function(){l.view.change(l.views.all[Math.max(0,l.views.all.indexOf(l.view.selected)-1)])},render:function(){var e=l.view.moment.clone().startOf(l.view.precision()).subtract(l.view.unit(),l.view.precision()),t=l.view.moment.clone().endOf(l.view.precision()).add(l.view.unit(),l.view.precision());l.view.previous.selectable=l.limits.isAfterOrEqualMin(e,l.view.precision()),l.view.previous.label=n.trustAsHtml(l.view.previous.selectable?l.leftArrow:"&nbsp;"),l.view.next.selectable=l.limits.isBeforeOrEqualMax(t,l.view.precision()),l.view.next.label=n.trustAsHtml(l.view.next.selectable?l.rightArrow:"&nbsp;"),l.view.title=l[l.view.selected+"View"].render()},change:function(e){var t=l.views.all.indexOf(e),n=l.views.all.indexOf(l.minView),i=l.views.all.indexOf(l.maxView);t<0||t>i?(l.valueUpdate(l.valueMoment=l.view.moment.clone()),l.view.close()):t>=n&&(l.view.selected=e)}},l.decadeView={fourYears:{},render:function(){var e=l.view.moment.clone();firstYear=10*Math.floor(e.year()/10)-1,lastYear=firstYear+11,e.year(firstYear),l.decadeView.fourYears={};for(var t=0;t<12;t++){var n=Math.floor(t/4),i=l.limits.isSelectable(e,"year");l.decadeView.fourYears[n]||(l.decadeView.fourYears[n]=[]),l.decadeView.fourYears[n].push({label:e.format(s.yearsFormat),year:e.year(),class:!i||[0,11].indexOf(t)>=0?"disabled":e.isSame(l.valueMoment,"year")?"selected":"",selectable:i}),e.add(1,"years")}return[e.subtract(2,"years").format("YYYY"),e.subtract(9,"years").format("YYYY")].reverse().join(" - ")},setYear:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year)),l.view.change("year"))}},l.yearView={fourMonths:{},render:function(){var e=l.view.moment.clone().startOf("year"),t=moment.monthsShort();return l.yearView.fourMonths={},t.forEach(function(t,n){var i=Math.floor(n/4),a=l.limits.isSelectable(e,"month");l.yearView.fourMonths[i]||(l.yearView.fourMonths[i]=[]),l.yearView.fourMonths[i].push({label:e.format(s.monthsFormat),year:e.year(),month:e.month(),class:a?e.isSame(l.valueMoment,"month")?"selected":"":"disabled",selectable:a}),e.add(1,"months")}),l.view.moment.format("YYYY")},setMonth:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year).month(e.month)),l.view.change("month"))}},l.monthView={days:function(){for(var e=[],t=moment().locale(l.locale).startOf("week"),n=0;n<7;n++)e.push(t.format("dd")),t.add(1,"days");return e}(),weeks:[],render:function(){var t=l.view.moment.month(),n=l.view.moment.clone().startOf("month").startOf("week"),i=(l.view.moment.clone().endOf("month").endOf("week"),n.week()),a=i+5;weeks={},l.monthView.weeks=[];for(var o=i;o<=a;o++)weeks[o]="0000000".split("").map(function(){var e=l.limits.isSelectable(n,"day"),i={label:n.format(s.daysFormat),year:n.year(),date:n.date(),month:n.month(),class:[l.today&&n.isSame(new Date,"day")?"today":"",e&&n.month()==t?n.isSame(l.valueMoment,"day")?"selected":"":"disabled"].join(" ").trim(),selectable:e};return n.add(1,"days"),i});return e.forEach(weeks,function(e){l.monthView.weeks.push(e)}),l.view.moment.format("MMMM YYYY")},setDate:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year).month(e.month).date(e.date)),l.view.change("day"))}},l.dayView={threeHours:[],render:function(){var e=l.view.moment.clone().startOf("day");moment.localeData().longDateFormat("LT").replace(/[aA]/,"");l.dayView.threeHours=[];for(var t=0;t<24;t++){var n=Math.floor(t/4),i=l.limits.isSelectable(e,"hour");l.dayView.threeHours[n]||(l.dayView.threeHours[n]=[]),l.dayView.threeHours[n].push({label:e.format(s.hoursFormat),year:e.year(),month:e.month(),date:e.date(),hour:e.hour(),class:i?e.isSame(l.valueMoment,"hour")?"selected":"":"disabled",selectable:i}),e.add(1,"hours")}return l.view.moment.format("LL")},setHour:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour)),l.view.change("hour"))}},l.hourView={minutes:[],render:function(){var e=0,t=l.view.moment.clone().startOf("hour"),n=s.minutesFormat||moment.localeData(l.locale).longDateFormat("LT").replace(/[aA]/,"");l.hourView.minutes=[];for(var i=0;i<60;i+=s.minutesStep){var a=Math.floor(e/4),o=l.limits.isSelectable(t,"minute");l.hourView.minutes[a]||(l.hourView.minutes[a]=[]),l.hourView.minutes[a].push({label:t.format(n),year:t.year(),month:t.month(),date:t.date(),hour:t.hour(),minute:t.minute(),class:o?t.isSame(l.valueMoment,"minute")?"selected":"":"disabled",selectable:o}),e++,t.add(s.minutesStep,"minutes")}return l.view.moment.clone().startOf("hour").format("lll")},setMinute:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour).minute(e.minute)),l.view.change("minute"))}},l.minuteView={seconds:[],render:function(){var e=0,t=l.view.moment.clone().startOf("minute");l.minuteView.seconds=[];for(var n=0;n<60;n+=s.secondsStep){var i=Math.floor(e/6),a=l.limits.isSelectable(t,"second");l.minuteView.seconds[i]||(l.minuteView.seconds[i]=[]),l.minuteView.seconds[i].push({label:t.format(s.secondsFormat),year:t.year(),month:t.month(),date:t.date(),hour:t.hour(),minute:t.minute(),second:t.second(),class:a?t.isSame(l.valueMoment,"second")?"selected":"":"disabled",selectable:a}),e++,t.add(s.secondsStep,"seconds")}return l.view.moment.clone().startOf("minute").format("lll")},setSecond:function(e){e.selectable&&(l.view.update(l.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour).minute(e.minute).second(e.second)),l.view.change("second"))}},l.picker=e.element('<span class="moment-picker"></span>'),m.after(l.picker),l.contents=m.addClass("moment-picker-contents").removeAttr("moment-picker"),l.icon=e.element(l.contents[0].querySelector(".date-time-picker-addon")),l.container=i(l.template)(l),l.picker.append(l.contents),l.picker.append(l.container),l.views.detectMinMax(),l.limits.checkView(),l.$watch("model",function(t,n){if(e.isDefined(t)&&e.isDefined(d)&&null!==d&&d.$pristine&&d.$setDirty(),e.isDefined(t)){if(null!==t)var i=Date.parse(t);if(!i||!i instanceof Date&&isNaN(i.valueOf())||"Invalid Date"===i)l.valueMoment=void 0;else{var a="L"===l.format||"L LT"===l.format?o("date")(t,"dateTime"):t;"MM"===l.format&&1===t.toString().length&&(a=("0"+t).slice(-2)),l.valueMoment=moment(a,l.format),l.view.moment=l.valueMoment.clone(),l.view.update()}l.valueUpdate(l.valueMoment),l.limits.checkValue()}}),l.$watch("value",function(n,i){var a=e.element(l.contents.find("[data-ng-model]")).controller("ngModel");if(e.isDefined(l.valueMoment)){var o=l.model,r=l.valueMoment.format(l.format);r!=o&&t(function(){l.view.update(l.view.moment=l.valueMoment.clone()),"false"===l.datetimeDefault&&("en"===moment.locale()&&(r=r.slice(0,11).concat(moment("12:00 AM","LT")._i)),"es"===moment.locale()&&(r=r.slice(0,11).concat(moment("12:00 a.m.","LT")._i))),l.model=r,e.isFunction(l.change)&&t(function(){l.change({newValue:r,oldValue:o})}),a.$setViewValue(r),a.$render()})}}),l.$watch("[view.selected, view.value]",l.view.render,!0),l.$watch("[minView, maxView]",function(){l.views.detectMinMax(),l.startView=l.views.all[Math.max(Math.min(l.views.all.indexOf(l.startView),l.views.all.indexOf(l.maxView)),l.views.all.indexOf(l.minView))],l.view.selected=l.startView}),l.$watch("[minDate, maxDate]",function(){e.forEach(["minDate","maxDate"],function(t){e.isDefined(l[t])&&(l[t+"Moment"]=moment(l[t],l.format,l.locale),l[t+"Moment"].isValid()||(l[t+"Moment"]=void 0))}),l.limits.checkValue(),l.limits.checkView(),l.view.render()},!0),l.$watch("locale",function(t,n){e.isDefined(n)&&t!=n&&(e.forEach(["model","minDate","maxDate"],function(i){e.isDefined(l[i])&&(l[i]=moment(l[i],l.format,n).locale(t).format(l.format))}),l.view.render())}),a.on("mouseup",function(){l.view.isOpen&&(t(l.view.close),e.element(l.icon).attr("state","dirty"))}),l.container.on("mouseup",function(e){e.stopPropagation()}),l.icon.on("mouseup",function(e){if(e.stopPropagation(),e.currentTarget.attributes.hasOwnProperty("disabled")&&"disabled"===e.currentTarget.attributes.disabled.name)return!1;l.view.isOpen?t(l.view.close):t(l.view.open)}),e.element(r).on("resize",l.view.position),a.on("keydown keypress",function(n){27===n.which&&(t(l.model=e.element(l.contents).find("input").val()),l.view.isOpen&&t(l.view.close))}),l.setToday=function(){t(function(){l.valueMoment=moment(),l.view.moment=l.valueMoment.clone(),l.view.update(),l.valueUpdate(l.valueMoment)}),t(l.view.close)}},l}();e.module("moment-picker",[]).provider("momentPicker",[function(){return new l}]).directive("momentPicker",["$timeout","$sce","$compile","$document","$filter","$window","momentPicker",function(e,t,n,i,a,o,r){return new m(e,t,n,i,a,o,r)}])}(window.angular);
