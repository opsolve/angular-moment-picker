/*! Angular Moment Picker - v0.5.6 - https://github.com/indrimuska/angular-moment-picker - (c) 2015 Indri Muska - MIT */
!function(a){var c,d,e,f,g,h,b=function(){function b(){defaults={locale:"en",format:"L LT",minView:"decade",maxView:"day",datetimeDefault:!0,startView:"month",today:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",secondsFormat:"ss",minutesStep:5,secondsStep:1}}return b.prototype.options=function(b){return a.extend(defaults,b),a.copy(defaults)},b.prototype.$get=function(){return defaults},b}(),i=function(){function b(a,b,i,j,k,l){this.restrict="A",this.scope={model:"=momentPicker",locale:"@?",format:"@?",minView:"@?",maxView:"@?",datetimeDefault:"@?",startView:"@?",minDate:"=?",maxDate:"=?",today:"=?",disabled:"=?disable",change:"&?"},c=a,d=b,e=i,f=j,g=k,h=l}return b.prototype.$inject=["$timeout","$sce","$compile","$document","$filter","momentPicker"],b.prototype.link=function(b,i,j){b.template='<div class="moment-picker-container {{view.selected}}-view" ng-show="view.isOpen && !disabled" ng-class="{\'moment-picker-disabled\': disabled, \'open\': view.isOpen}"><table class="header-view"><thead><tr><th ng-class="{disabled: !view.previous.selectable}" ng-bind-html="view.previous.label" ng-click="view.previous.set()"></th><th ng-bind="view.title" ng-click="view.setParentView()"></th><th ng-class="{disabled: !view.next.selectable}" ng-bind-html="view.next.label" ng-click="view.next.set()"></th></tr></thead></table><div class="moment-picker-specific-views"><table ng-if="view.selected == \'decade\'"><tbody><tr ng-repeat="fourYear in decadeView.fourYears"><td ng-repeat="year in fourYear track by year.year" ng-class="year.class" ng-bind="year.label" ng-click="decadeView.setYear(year)"></td></tr></tbody></table><table ng-if="view.selected == \'year\'"><tbody><tr ng-repeat="fourMonth in yearView.fourMonths"><td ng-repeat="month in fourMonth track by month.month" ng-class="month.class" ng-bind="month.label" ng-click="yearView.setMonth(month)"></td></tr></tbody></table><table ng-if="view.selected == \'month\'"><thead><tr><th ng-repeat="day in monthView.days" ng-bind="day"></th></tr></thead><tbody><tr ng-repeat="days in monthView.weeks"><td ng-repeat="day in days track by day.date" ng-class="day.class" ng-bind="day.label" ng-click="monthView.setDate(day)"></td></tr></tbody></table><table ng-if="view.selected == \'day\'"><tbody><tr ng-repeat="threeHours in dayView.threeHours"><td ng-repeat="hour in threeHours track by hour.hour" ng-class="hour.class" ng-bind="hour.label" ng-click="dayView.setHour(hour)"></td></tr></tbody></table><table ng-if="view.selected == \'hour\'"><tbody><tr ng-repeat="minutes in hourView.minutes"><td ng-repeat="minute in minutes" ng-class="minute.class" ng-bind="minute.label" ng-click="hourView.setMinute(minute)"></td></tr></tbody></table><table ng-if="view.selected == \'minute\'"><tbody><tr ng-repeat="seconds in minuteView.seconds"><td ng-repeat="second in seconds" ng-class="second.class" ng-bind="second.label" ng-click="minuteView.setSecond(second)"></td></tr></tbody></table></div></div>',"false"===b.datetimeDefault&&(b.maxView="month"),a.forEach(["locale","format","minView","maxView","startView","today","leftArrow","rightArrow"],function(c){a.isDefined(b[c])||(b[c]=h[c]),a.isDefined(j[c])||(j[c]=b[c])}),b.momentToDate=function(b){return a.isDefined(b)&&b.isValid()?b.clone().toDate():void 0},b.valueUpdate=function(){b.disabled||(b.value=b.momentToDate(b.valueMoment))},b.limits={isAfterOrEqualMin:function(c,d){return!a.isDefined(b.minDateMoment)||c.isAfter(b.minDateMoment,d)||c.isSame(b.minDateMoment,d)},isBeforeOrEqualMax:function(c,d){return!a.isDefined(b.maxDateMoment)||c.isBefore(b.maxDateMoment,d)||c.isSame(b.maxDateMoment,d)},isSelectable:function(a,c){return b.limits.isAfterOrEqualMin(a,c)&&b.limits.isBeforeOrEqualMax(a,c)},checkValue:function(){a.isDefined(b.valueMoment)&&(b.limits.isAfterOrEqualMin(b.valueMoment)||b.valueUpdate(b.valueMoment=b.minDateMoment.clone()),b.limits.isBeforeOrEqualMax(b.valueMoment)||b.valueUpdate(b.valueMoment=b.maxDateMoment.clone()))},checkView:function(){a.isDefined(b.view.moment)||(b.view.moment=moment().locale(b.locale)),b.limits.isAfterOrEqualMin(b.view.moment)||(b.view.moment=b.minDateMoment.clone()),b.limits.isBeforeOrEqualMax(b.view.moment)||(b.view.moment=b.maxDateMoment.clone()),b.view.update()}},b.views={all:["decade","year","month","day","hour","minute"],formats:{decade:"Y{1,2}(?!Y)|YYYY|[Ll]{1,4}(?!T)",year:"M{1,4}(?![Mo])|Mo|Q",month:"[Dd]{1,4}(?![Ddo])|DDDo|[Dd]o|[Ww]{1,2}(?![Wwo])|[Ww]o|[Ee]|L{1,2}(?!T)|l{1,2}",day:"[Hh]{1,2}|LTS?",hour:"m{1,2}|[Ll]{3,4}|LT(?!S)",minute:"s{1,2}|S{1,}|X|LTS"},detectMinMax:function(){var c,d;a.forEach(b.views.formats,function(e,f){var g=new RegExp("("+e+")(?![^[]*])","g");b.format.match(g)&&(a.isDefined(c)||(c=f),d=f)}),c=a.isDefined(c)?Math.max(0,b.views.all.indexOf(c)):0,d=a.isDefined(d)?Math.min(b.views.all.length-1,b.views.all.indexOf(d)):b.views.all.length-1,c>b.views.all.indexOf(b.minView)&&(b.minView=b.views.all[c]),d<b.views.all.indexOf(b.maxView)&&(b.maxView=b.views.all[d])}},b.view={isOpen:!1,selected:b.startView,update:function(){b.view.value=b.momentToDate(b.view.moment)},toggle:function(){b.view.isOpen?b.view.close():b.view.open()},open:function(){a.forEach(f[0].querySelectorAll(".moment-picker-container.open"),function(b){((a.element(b).scope().view||{}).close||a.noop)()}),b.disabled||(b.view.isOpen=!0)},close:function(){b.view.isOpen=!1,b.view.selected=b.startView},unit:function(){return"decade"==b.view.selected?10:1},precision:function(){return b.view.selected.replace("decade","year")},title:"",previous:{selectable:!0,label:d.trustAsHtml(b.leftArrow),selectable:!0,set:function(){b.view.previous.selectable&&b.view.update(b.view.moment.subtract(b.view.unit(),b.view.precision()).toDate())}},next:{selectable:!0,label:d.trustAsHtml(b.rightArrow),set:function(){b.view.next.selectable&&b.view.update(b.view.moment.add(b.view.unit(),b.view.precision()).toDate())}},setParentView:function(){b.view.change(b.views.all[Math.max(0,b.views.all.indexOf(b.view.selected)-1)])},render:function(){var a=b.view.moment.clone().startOf(b.view.precision()).subtract(b.view.unit(),b.view.precision()),c=b.view.moment.clone().endOf(b.view.precision()).add(b.view.unit(),b.view.precision());b.view.previous.selectable=b.limits.isAfterOrEqualMin(a,b.view.precision()),b.view.previous.label=d.trustAsHtml(b.view.previous.selectable?b.leftArrow:"&nbsp;"),b.view.next.selectable=b.limits.isBeforeOrEqualMax(c,b.view.precision()),b.view.next.label=d.trustAsHtml(b.view.next.selectable?b.rightArrow:"&nbsp;"),b.view.title=b[b.view.selected+"View"].render()},change:function(a){var c=b.views.all.indexOf(a),d=b.views.all.indexOf(b.minView),e=b.views.all.indexOf(b.maxView);c<0||c>e?(b.valueUpdate(b.valueMoment=b.view.moment.clone()),b.view.close()):c>=d&&(b.view.selected=a)}},b.decadeView={fourYears:{},render:function(){var a=b.view.moment.clone();firstYear=10*Math.floor(a.year()/10)-1,lastYear=firstYear+11,a.year(firstYear),b.decadeView.fourYears={};for(var c=0;c<12;c++){var d=Math.floor(c/4),e=b.limits.isSelectable(a,"year");b.decadeView.fourYears[d]||(b.decadeView.fourYears[d]=[]),b.decadeView.fourYears[d].push({label:a.format(h.yearsFormat),year:a.year(),class:!e||[0,11].indexOf(c)>=0?"disabled":a.isSame(b.valueMoment,"year")?"selected":"",selectable:e}),a.add(1,"years")}return[a.subtract(2,"years").format("YYYY"),a.subtract(9,"years").format("YYYY")].reverse().join(" - ")},setYear:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year)),b.view.change("year"))}},b.yearView={fourMonths:{},render:function(){var a=b.view.moment.clone().startOf("year"),c=moment.monthsShort();return b.yearView.fourMonths={},c.forEach(function(c,d){var e=Math.floor(d/4),f=b.limits.isSelectable(a,"month");b.yearView.fourMonths[e]||(b.yearView.fourMonths[e]=[]),b.yearView.fourMonths[e].push({label:a.format(h.monthsFormat),year:a.year(),month:a.month(),class:f?a.isSame(b.valueMoment,"month")?"selected":"":"disabled",selectable:f}),a.add(1,"months")}),b.view.moment.format("YYYY")},setMonth:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year).month(a.month)),b.view.change("month"))}},b.monthView={days:function(){for(var a=[],c=moment().locale(b.locale).startOf("week"),d=0;d<7;d++)a.push(c.format("dd")),c.add(1,"days");return a}(),weeks:[],render:function(){var c=b.view.moment.month(),d=b.view.moment.clone().startOf("month").startOf("week"),f=(b.view.moment.clone().endOf("month").endOf("week"),d.week()),g=f+5;weeks={},b.monthView.weeks=[];for(var i=f;i<=g;i++)weeks[i]="0000000".split("").map(function(){var a=b.limits.isSelectable(d,"day"),e={label:d.format(h.daysFormat),year:d.year(),date:d.date(),month:d.month(),class:[b.today&&d.isSame(new Date,"day")?"today":"",a&&d.month()==c?d.isSame(b.valueMoment,"day")?"selected":"":"disabled"].join(" ").trim(),selectable:a};return d.add(1,"days"),e});return a.forEach(weeks,function(a){b.monthView.weeks.push(a)}),b.view.moment.format("MMMM YYYY")},setDate:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year).month(a.month).date(a.date)),b.view.change("day"))}},b.dayView={threeHours:[],render:function(){var a=b.view.moment.clone().startOf("day");moment.localeData().longDateFormat("LT").replace(/[aA]/,"");b.dayView.threeHours=[];for(var d=0;d<24;d++){var e=Math.floor(d/4),f=b.limits.isSelectable(a,"hour");b.dayView.threeHours[e]||(b.dayView.threeHours[e]=[]),b.dayView.threeHours[e].push({label:a.format(h.hoursFormat),year:a.year(),month:a.month(),date:a.date(),hour:a.hour(),class:f?a.isSame(b.valueMoment,"hour")?"selected":"":"disabled",selectable:f}),a.add(1,"hours")}return b.view.moment.format("LL")},setHour:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour)),b.view.change("hour"))}},b.hourView={minutes:[],render:function(){var a=0,c=b.view.moment.clone().startOf("hour"),d=h.minutesFormat||moment.localeData(b.locale).longDateFormat("LT").replace(/[aA]/,"");b.hourView.minutes=[];for(var e=0;e<60;e+=h.minutesStep){var f=Math.floor(a/4),g=b.limits.isSelectable(c,"minute");b.hourView.minutes[f]||(b.hourView.minutes[f]=[]),b.hourView.minutes[f].push({label:c.format(d),year:c.year(),month:c.month(),date:c.date(),hour:c.hour(),minute:c.minute(),class:g?c.isSame(b.valueMoment,"minute")?"selected":"":"disabled",selectable:g}),a++,c.add(h.minutesStep,"minutes")}return b.view.moment.clone().startOf("hour").format("lll")},setMinute:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour).minute(a.minute)),b.view.change("minute"))}},b.minuteView={seconds:[],render:function(){var a=0,c=b.view.moment.clone().startOf("minute");b.minuteView.seconds=[];for(var d=0;d<60;d+=h.secondsStep){var e=Math.floor(a/6),f=b.limits.isSelectable(c,"second");b.minuteView.seconds[e]||(b.minuteView.seconds[e]=[]),b.minuteView.seconds[e].push({label:c.format(h.secondsFormat),year:c.year(),month:c.month(),date:c.date(),hour:c.hour(),minute:c.minute(),second:c.second(),class:f?c.isSame(b.valueMoment,"second")?"selected":"":"disabled",selectable:f}),a++,c.add(h.secondsStep,"seconds")}return b.view.moment.clone().startOf("minute").format("lll")},setSecond:function(a){a.selectable&&(b.view.update(b.view.moment.year(a.year).month(a.month).date(a.date).hour(a.hour).minute(a.minute).second(a.second)),b.view.change("second"))}},b.picker=a.element('<span class="moment-picker"></span>'),i.after(b.picker),b.contents=i.addClass("moment-picker-contents").removeAttr("moment-picker"),b.icon=a.element(b.contents[0].querySelector(".input-group-addon")),b.container=e(b.template)(b),b.picker.append(b.contents),b.picker.append(b.container),b.views.detectMinMax(),b.limits.checkView(),b.$watch("model",function(c,d){if(a.isDefined(c)){if(null!==c)var e=Date.parse(c);if(!e||!e instanceof Date&&isNaN(e.valueOf())||"Invalid Date"===e)b.valueMoment=void 0;else{var f="L"===b.format||"L LT"===b.format?g("date")(c,"dateTime"):c;"MM"===b.format&&1===c.toString().length&&(f=("0"+c).slice(-2)),b.valueMoment=moment(f,b.format),b.view.moment=b.valueMoment.clone(),b.view.update()}b.valueUpdate(b.valueMoment),b.limits.checkValue()}}),b.$watch("value",function(d,e){if(a.isDefined(b.valueMoment)){var f=b.model,g=b.valueMoment.format(b.format);g!=f&&c(function(){b.view.update(b.view.moment=b.valueMoment.clone()),"false"===b.datetimeDefault&&("en"===moment.locale()&&(g=g.slice(0,11).concat(moment("12:00 AM","LT")._i)),"es"===moment.locale()&&(g=g.slice(0,11).concat(moment("12:00 a.m.","LT")._i))),b.model=g,a.isFunction(b.change)&&c(function(){b.change({newValue:g,oldValue:f})},0,!1)})}}),b.$watch("[view.selected, view.value]",b.view.render,!0),b.$watch("[minView, maxView]",function(){b.views.detectMinMax(),b.startView=b.views.all[Math.max(Math.min(b.views.all.indexOf(b.startView),b.views.all.indexOf(b.maxView)),b.views.all.indexOf(b.minView))],b.view.selected=b.startView}),b.$watch("[minDate, maxDate]",function(){a.forEach(["minDate","maxDate"],function(c){a.isDefined(b[c])&&(b[c+"Moment"]=moment(b[c],b.format,b.locale),b[c+"Moment"].isValid()||(b[c+"Moment"]=void 0))}),b.limits.checkValue(),b.limits.checkView(),b.view.render()},!0),b.$watch("locale",function(c,d){a.isDefined(d)&&c!=d&&(a.forEach(["model","minDate","maxDate"],function(e){a.isDefined(b[e])&&(b[e]=moment(b[e],b.format,d).locale(c).format(b.format))}),b.view.render())}),f.on("click",function(){b.view.isOpen&&c(b.view.close)}),b.container.on("click",function(a){a.stopPropagation()}),b.icon.on("click",function(a){a.stopPropagation(),c(b.view.isOpen?b.view.close:b.view.open)}),f.on("keydown keypress",function(d){27===d.which&&(c(b.model=a.element(b.contents).find("input").val()),b.view.isOpen&&c(b.view.close))})},b}();a.module("moment-picker",[]).provider("momentPicker",[function(){return new b}]).directive("momentPicker",["$timeout","$sce","$compile","$document","$filter","momentPicker",function(a,b,c,d,e,f){return new i(a,b,c,d,e,f)}])}(window.angular);
