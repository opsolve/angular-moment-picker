/*! Angular Moment Picker - v0.5.6 - https://github.com/indrimuska/angular-moment-picker - (c) 2015 Indri Muska - MIT */
!function(e){var t,n,i,a,o,r,s=function(){function t(){defaults={locale:"en",format:"L LT",minView:"decade",maxView:"day",datetimeDefault:!0,startView:"month",today:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",secondsFormat:"ss",minutesStep:5,secondsStep:1}}return t.prototype.options=function(t){return e.extend(defaults,t),e.copy(defaults)},t.prototype.$get=function(){return defaults},t}(),l=function(){function s(e,s,l,m,c,d){this.restrict="A",this.scope={model:"=momentPicker",locale:"@?",format:"@?",minView:"@?",maxView:"@?",datetimeDefault:"@?",startView:"@?",minDate:"=?",maxDate:"=?",today:"=?",disabled:"=?disable",change:"&?"},t=e,n=s,i=l,a=m,o=c,r=d}return s.prototype.$inject=["$timeout","$sce","$compile","$document","$filter","momentPicker"],s.prototype.link=function(s,l,m){s.template='<div class="moment-picker-container {{view.selected}}-view" ng-show="view.isOpen && !disabled" ng-class="{\'moment-picker-disabled\': disabled, \'open\': view.isOpen}"><table class="header-view"><thead><tr><th ng-class="{disabled: !view.previous.selectable}" ng-bind-html="view.previous.label" ng-click="view.previous.set()"></th><th ng-bind="view.title" ng-click="view.setParentView()"></th><th ng-class="{disabled: !view.next.selectable}" ng-bind-html="view.next.label" ng-click="view.next.set()"></th></tr></thead></table><div class="moment-picker-specific-views"><table ng-if="view.selected == \'decade\'"><tbody><tr ng-repeat="fourYear in decadeView.fourYears"><td ng-repeat="year in fourYear track by year.year" ng-class="year.class" ng-bind="year.label" ng-click="decadeView.setYear(year)"></td></tr></tbody></table><table ng-if="view.selected == \'year\'"><tbody><tr ng-repeat="fourMonth in yearView.fourMonths"><td ng-repeat="month in fourMonth track by month.month" ng-class="month.class" ng-bind="month.label" ng-click="yearView.setMonth(month)"></td></tr></tbody></table><table ng-if="view.selected == \'month\'"><thead><tr><th ng-repeat="day in monthView.days" ng-bind="day"></th></tr></thead><tbody><tr ng-repeat="days in monthView.weeks"><td ng-repeat="day in days track by day.date" ng-class="day.class" ng-bind="day.label" ng-click="monthView.setDate(day)"></td></tr></tbody></table><table ng-if="view.selected == \'day\'"><tbody><tr ng-repeat="threeHours in dayView.threeHours"><td ng-repeat="hour in threeHours track by hour.hour" ng-class="hour.class" ng-bind="hour.label" ng-click="dayView.setHour(hour)"></td></tr></tbody></table><table ng-if="view.selected == \'hour\'"><tbody><tr ng-repeat="minutes in hourView.minutes"><td ng-repeat="minute in minutes" ng-class="minute.class" ng-bind="minute.label" ng-click="hourView.setMinute(minute)"></td></tr></tbody></table><table ng-if="view.selected == \'minute\'"><tbody><tr ng-repeat="seconds in minuteView.seconds"><td ng-repeat="second in seconds" ng-class="second.class" ng-bind="second.label" ng-click="minuteView.setSecond(second)"></td></tr></tbody></table></div></div>',"false"===s.datetimeDefault&&(s.maxView="month"),e.forEach(["locale","format","minView","maxView","startView","today","leftArrow","rightArrow"],function(t){e.isDefined(s[t])||(s[t]=r[t]),e.isDefined(m[t])||(m[t]=s[t])}),s.momentToDate=function(t){return e.isDefined(t)&&t.isValid()?t.clone().toDate():void 0},s.valueUpdate=function(){s.disabled||(s.value=s.momentToDate(s.valueMoment))},s.limits={isAfterOrEqualMin:function(t,n){return!e.isDefined(s.minDateMoment)||t.isAfter(s.minDateMoment,n)||t.isSame(s.minDateMoment,n)},isBeforeOrEqualMax:function(t,n){return!e.isDefined(s.maxDateMoment)||t.isBefore(s.maxDateMoment,n)||t.isSame(s.maxDateMoment,n)},isSelectable:function(e,t){return s.limits.isAfterOrEqualMin(e,t)&&s.limits.isBeforeOrEqualMax(e,t)},checkValue:function(){e.isDefined(s.valueMoment)&&(s.limits.isAfterOrEqualMin(s.valueMoment)||s.valueUpdate(s.valueMoment=s.minDateMoment.clone()),s.limits.isBeforeOrEqualMax(s.valueMoment)||s.valueUpdate(s.valueMoment=s.maxDateMoment.clone()))},checkView:function(){e.isDefined(s.view.moment)||(s.view.moment=moment().locale(s.locale)),s.limits.isAfterOrEqualMin(s.view.moment)||(s.view.moment=s.minDateMoment.clone()),s.limits.isBeforeOrEqualMax(s.view.moment)||(s.view.moment=s.maxDateMoment.clone()),s.view.update()}},s.views={all:["decade","year","month","day","hour","minute"],formats:{decade:"Y{1,2}(?!Y)|YYYY|[Ll]{1,4}(?!T)",year:"M{1,4}(?![Mo])|Mo|Q",month:"[Dd]{1,4}(?![Ddo])|DDDo|[Dd]o|[Ww]{1,2}(?![Wwo])|[Ww]o|[Ee]|L{1,2}(?!T)|l{1,2}",day:"[Hh]{1,2}|LTS?",hour:"m{1,2}|[Ll]{3,4}|LT(?!S)",minute:"s{1,2}|S{1,}|X|LTS"},detectMinMax:function(){var t,n;e.forEach(s.views.formats,function(i,a){var o=new RegExp("("+i+")(?![^[]*])","g");s.format.match(o)&&(e.isDefined(t)||(t=a),n=a)}),t=e.isDefined(t)?Math.max(0,s.views.all.indexOf(t)):0,n=e.isDefined(n)?Math.min(s.views.all.length-1,s.views.all.indexOf(n)):s.views.all.length-1,t>s.views.all.indexOf(s.minView)&&(s.minView=s.views.all[t]),n<s.views.all.indexOf(s.maxView)&&(s.maxView=s.views.all[n])}},s.view={isOpen:!1,selected:s.startView,update:function(){s.view.value=s.momentToDate(s.view.moment)},toggle:function(){s.view.isOpen?s.view.close():s.view.open()},open:function(){e.forEach(a[0].querySelectorAll(".moment-picker-container.open"),function(t){((e.element(t).scope().view||{}).close||e.noop)()}),s.disabled||(s.view.isOpen=!0)},close:function(){s.view.isOpen=!1,s.view.selected=s.startView},unit:function(){return"decade"==s.view.selected?10:1},precision:function(){return s.view.selected.replace("decade","year")},title:"",previous:{selectable:!0,label:n.trustAsHtml(s.leftArrow),selectable:!0,set:function(){s.view.previous.selectable&&s.view.update(s.view.moment.subtract(s.view.unit(),s.view.precision()).toDate())}},next:{selectable:!0,label:n.trustAsHtml(s.rightArrow),set:function(){s.view.next.selectable&&s.view.update(s.view.moment.add(s.view.unit(),s.view.precision()).toDate())}},setParentView:function(){s.view.change(s.views.all[Math.max(0,s.views.all.indexOf(s.view.selected)-1)])},render:function(){var e=s.view.moment.clone().startOf(s.view.precision()).subtract(s.view.unit(),s.view.precision()),t=s.view.moment.clone().endOf(s.view.precision()).add(s.view.unit(),s.view.precision());s.view.previous.selectable=s.limits.isAfterOrEqualMin(e,s.view.precision()),s.view.previous.label=n.trustAsHtml(s.view.previous.selectable?s.leftArrow:"&nbsp;"),s.view.next.selectable=s.limits.isBeforeOrEqualMax(t,s.view.precision()),s.view.next.label=n.trustAsHtml(s.view.next.selectable?s.rightArrow:"&nbsp;"),s.view.title=s[s.view.selected+"View"].render()},change:function(e){var t=s.views.all.indexOf(e),n=s.views.all.indexOf(s.minView),i=s.views.all.indexOf(s.maxView);0>t||t>i?(s.valueUpdate(s.valueMoment=s.view.moment.clone()),s.view.close()):t>=n&&(s.view.selected=e)}},s.decadeView={fourYears:{},render:function(){var e=s.view.moment.clone();firstYear=10*Math.floor(e.year()/10)-1,lastYear=firstYear+11,e.year(firstYear),s.decadeView.fourYears={};for(var t=0;12>t;t++){var n=Math.floor(t/4),i=s.limits.isSelectable(e,"year");s.decadeView.fourYears[n]||(s.decadeView.fourYears[n]=[]),s.decadeView.fourYears[n].push({label:e.format(r.yearsFormat),year:e.year(),"class":!i||[0,11].indexOf(t)>=0?"disabled":e.isSame(s.valueMoment,"year")?"selected":"",selectable:i}),e.add(1,"years")}return[e.subtract(2,"years").format("YYYY"),e.subtract(9,"years").format("YYYY")].reverse().join(" - ")},setYear:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year)),s.view.change("year"))}},s.yearView={fourMonths:{},render:function(){var e=s.view.moment.clone().startOf("year"),t=moment.monthsShort();return s.yearView.fourMonths={},t.forEach(function(t,n){var i=Math.floor(n/4),a=s.limits.isSelectable(e,"month");s.yearView.fourMonths[i]||(s.yearView.fourMonths[i]=[]),s.yearView.fourMonths[i].push({label:e.format(r.monthsFormat),year:e.year(),month:e.month(),"class":a?e.isSame(s.valueMoment,"month")?"selected":"":"disabled",selectable:a}),e.add(1,"months")}),s.view.moment.format("YYYY")},setMonth:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year).month(e.month)),s.view.change("month"))}},s.monthView={days:function(){for(var e=[],t=moment().locale(s.locale).startOf("week"),n=0;7>n;n++)e.push(t.format("dd")),t.add(1,"days");return e}(),weeks:[],render:function(){var t=s.view.moment.month(),n=s.view.moment.clone().startOf("month").startOf("week"),i=(s.view.moment.clone().endOf("month").endOf("week"),n.week()),a=i+5;weeks={},s.monthView.weeks=[];for(var o=i;a>=o;o++)weeks[o]="0000000".split("").map(function(){var e=s.limits.isSelectable(n,"day"),i={label:n.format(r.daysFormat),year:n.year(),date:n.date(),month:n.month(),"class":[s.today&&n.isSame(new Date,"day")?"today":"",e&&n.month()==t?n.isSame(s.valueMoment,"day")?"selected":"":"disabled"].join(" ").trim(),selectable:e};return n.add(1,"days"),i});return e.forEach(weeks,function(e){s.monthView.weeks.push(e)}),s.view.moment.format("MMMM YYYY")},setDate:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year).month(e.month).date(e.date)),s.view.change("day"))}},s.dayView={threeHours:[],render:function(){var e=s.view.moment.clone().startOf("day");moment.localeData().longDateFormat("LT").replace(/[aA]/,"");s.dayView.threeHours=[];for(var t=0;24>t;t++){var n=Math.floor(t/4),i=s.limits.isSelectable(e,"hour");s.dayView.threeHours[n]||(s.dayView.threeHours[n]=[]),s.dayView.threeHours[n].push({label:e.format(r.hoursFormat),year:e.year(),month:e.month(),date:e.date(),hour:e.hour(),"class":i?e.isSame(s.valueMoment,"hour")?"selected":"":"disabled",selectable:i}),e.add(1,"hours")}return s.view.moment.format("LL")},setHour:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour)),s.view.change("hour"))}},s.hourView={minutes:[],render:function(){var e=0,t=s.view.moment.clone().startOf("hour"),n=r.minutesFormat||moment.localeData(s.locale).longDateFormat("LT").replace(/[aA]/,"");s.hourView.minutes=[];for(var i=0;60>i;i+=r.minutesStep){var a=Math.floor(e/4),o=s.limits.isSelectable(t,"minute");s.hourView.minutes[a]||(s.hourView.minutes[a]=[]),s.hourView.minutes[a].push({label:t.format(n),year:t.year(),month:t.month(),date:t.date(),hour:t.hour(),minute:t.minute(),"class":o?t.isSame(s.valueMoment,"minute")?"selected":"":"disabled",selectable:o}),e++,t.add(r.minutesStep,"minutes")}return s.view.moment.clone().startOf("hour").format("lll")},setMinute:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour).minute(e.minute)),s.view.change("minute"))}},s.minuteView={seconds:[],render:function(){var e=0,t=s.view.moment.clone().startOf("minute");s.minuteView.seconds=[];for(var n=0;60>n;n+=r.secondsStep){var i=Math.floor(e/6),a=s.limits.isSelectable(t,"second");s.minuteView.seconds[i]||(s.minuteView.seconds[i]=[]),s.minuteView.seconds[i].push({label:t.format(r.secondsFormat),year:t.year(),month:t.month(),date:t.date(),hour:t.hour(),minute:t.minute(),second:t.second(),"class":a?t.isSame(s.valueMoment,"second")?"selected":"":"disabled",selectable:a}),e++,t.add(r.secondsStep,"seconds")}return s.view.moment.clone().startOf("minute").format("lll")},setSecond:function(e){e.selectable&&(s.view.update(s.view.moment.year(e.year).month(e.month).date(e.date).hour(e.hour).minute(e.minute).second(e.second)),s.view.change("second"))}},s.picker=e.element('<span class="moment-picker"></span>'),l.after(s.picker),s.contents=l.addClass("moment-picker-contents").removeAttr("moment-picker"),s.icon=e.element(s.contents[0].querySelector(".input-group-addon")),s.container=i(s.template)(s),s.picker.append(s.contents),s.picker.append(s.container),s.views.detectMinMax(),s.limits.checkView(),s.$watch("model",function(t,n){if(e.isDefined(t)){if(null!==t)var i=Date.parse(t);if(!i||!i instanceof Date&&isNaN(i.valueOf())||"Invalid Date"===i)s.valueMoment=void 0;else{var a=o("date")(t,"dateTime");s.valueMoment=moment(a,s.format),s.view.moment=s.valueMoment.clone(),s.view.update()}s.valueUpdate(s.valueMoment),s.limits.checkValue()}}),s.$watch("value",function(n,i){if(e.isDefined(s.valueMoment)){var a=s.model,o=s.valueMoment.format(s.format);o!=a&&t(function(){s.view.update(s.view.moment=s.valueMoment.clone()),"false"===s.datetimeDefault&&("en"===moment.locale()&&(o=o.slice(0,11).concat(moment("12:00 AM","LT")._i)),"es"===moment.locale()&&(o=o.slice(0,11).concat(moment("12:00 a.m.","LT")._i))),s.model=o,e.isFunction(s.change)&&t(function(){s.change({newValue:o,oldValue:a})},0,!1)})}}),s.$watch("[view.selected, view.value]",s.view.render,!0),s.$watch("[minView, maxView]",function(){s.views.detectMinMax(),s.startView=s.views.all[Math.max(Math.min(s.views.all.indexOf(s.startView),s.views.all.indexOf(s.maxView)),s.views.all.indexOf(s.minView))],s.view.selected=s.startView}),s.$watch("[minDate, maxDate]",function(){e.forEach(["minDate","maxDate"],function(t){e.isDefined(s[t])&&(s[t+"Moment"]=moment(s[t],s.format,s.locale),s[t+"Moment"].isValid()||(s[t+"Moment"]=void 0))}),s.limits.checkValue(),s.limits.checkView(),s.view.render()},!0),s.$watch("locale",function(t,n){e.isDefined(n)&&t!=n&&(e.forEach(["model","minDate","maxDate"],function(i){e.isDefined(s[i])&&(s[i]=moment(s[i],s.format,n).locale(t).format(s.format))}),s.view.render())}),a.on("click",function(){s.view.isOpen&&t(s.view.close)}),s.container.on("click",function(e){e.stopPropagation()}),s.icon.on("click",function(e){e.stopPropagation(),t(s.view.isOpen?s.view.close:s.view.open)}),a.on("keydown keypress",function(n){27===n.which&&(t(s.model=e.element(s.contents).find("input").val()),s.view.isOpen&&t(s.view.close))})},s}();e.module("moment-picker",[]).provider("momentPicker",[function(){return new s}]).directive("momentPicker",["$timeout","$sce","$compile","$document","$filter","momentPicker",function(e,t,n,i,a,o){return new l(e,t,n,i,a,o)}])}(window.angular);
